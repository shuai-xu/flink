##############################################################################
#
# @authors niwan@taobao.com
#
# Test blink stability when rpc timeout

#
RULE RPC connection timeout(on ActorSelection.tell())
CLASS akka.actor.ActorSelection
METHOD tell(java.lang.Object, akka.actor.ActorRef)
HELPER com.alibaba.blink.stabilitytest.STCaseHelper
AT ENTRY
COMPILE
BIND actorSel = $0; message = $1; sender = $2;
IF TRUE
DO
    invokeSTMethod("org.apache.flink.runtime.rpc.akka.AkkaRpcTimeoutSTCase", "connectTimeout", new Object[]{actorSel, message, sender});
ENDRULE

#
RULE RPC ask timeout(on ActorRef.tell())
CLASS akka.actor.ActorRef
METHOD tell(java.lang.Object, akka.actor.ActorRef)
HELPER com.alibaba.blink.stabilitytest.STCaseHelper
AT ENTRY
COMPILE
BIND actorRef = $0; message = $1; sender = $2;
IF TRUE
DO
    invokeSTMethod("org.apache.flink.runtime.rpc.akka.AkkaRpcTimeoutSTCase", "askTimeout", new Object[]{actorRef, message, sender});
ENDRULE
