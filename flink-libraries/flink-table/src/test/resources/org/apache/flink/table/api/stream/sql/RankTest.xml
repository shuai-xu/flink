<?xml version="1.0" ?>
<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to you under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<Root>
  <TestCase name="testUnarySortTopNOnString">
	<Resource name="plan">
		<![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[category], orderBy=[max_price ASC], rankRange=[rankStart=1, rankEnd=3], strategy=[UnaryUpdateRank[0,1]], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[category]])
    StreamExecGroupAggregate(groupBy=[category, shopId], select=[category, shopId, MAX(price) AS max_price])
      StreamExecExchange(distribution=[hash[category, shopId]])
        StreamExecDataStreamScan(table=[[_DataStreamTable_1]])
]]>
	</Resource>
	<Resource name="trait">
		<![CDATA[
StreamExecRank(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[false], accMode=[Acc])
    StreamExecGroupAggregate(retract=[false], accMode=[Acc])
      StreamExecExchange(retract=[true], accMode=[Acc])
        StreamExecDataStreamScan(retract=[true], accMode=[Acc])
]]>
	</Resource>
  </TestCase>
	<TestCase name="testTopNWithPartialFinalAgg">
		<Resource name="plan">
			<![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[b], orderBy=[$f3 DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[UpdateFastRank[0,1]], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[b]])
    StreamExecGlobalGroupAggregate(groupBy=[a, b], select=[a, b, SUM_RETRACT((sum$0, count$1)) AS $f2, $SUM0_RETRACT(sum0$2) AS $f3])
      StreamExecExchange(distribution=[hash[a, b]])
        StreamExecLocalGroupAggregate(groupBy=[a, b], select=[a, b, SUM_RETRACT($f3_0) AS (sum$0, count$1), $SUM0_RETRACT($f4) AS sum0$2, COUNT_RETRACT(*) AS count$3])
          StreamExecGlobalGroupAggregate(groupBy=[a, b, $f3], select=[a, b, $f3, SUM(sum$0) AS $f3_0, COUNT(distinct$0 count$1) AS $f4])
            StreamExecExchange(distribution=[hash[a, b, $f3]])
              StreamExecLocalGroupAggregate(groupBy=[a, b, $f3], select=[a, b, $f3, SUM(c) FILTER $g_1 AS sum$0, COUNT(distinct$0 c) FILTER $g_0 AS count$1, DISTINCT(c) AS distinct$0])
                StreamExecCalc(select=[a, b, c, $f3, =($e, 1) AS $g_1, =($e, 0) AS $g_0])
                  StreamExecExpand(projects=[{a, b, c, $f3, 0 AS $e}, {a, b, c, null AS $f3, 1 AS $e}])
                    StreamExecCalc(select=[a, b, c, MOD(HASH_CODE(c), 256) AS $f3], where=[>=(c, 0)])
                      StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
		</Resource>
		<Resource name="trait">
			<![CDATA[
StreamExecRank(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[false], accMode=[Acc])
    StreamExecGlobalGroupAggregate(retract=[false], accMode=[Acc])
      StreamExecExchange(retract=[true], accMode=[Acc])
        StreamExecLocalGroupAggregate(retract=[true], accMode=[Acc])
          StreamExecGlobalGroupAggregate(retract=[true], accMode=[AccRetract])
            StreamExecExchange(retract=[true], accMode=[Acc])
              StreamExecLocalGroupAggregate(retract=[true], accMode=[Acc])
                StreamExecCalc(retract=[true], accMode=[Acc])
                  StreamExecExpand(retract=[true], accMode=[Acc])
                    StreamExecCalc(retract=[true], accMode=[Acc])
                      StreamExecDataStreamScan(retract=[true], accMode=[Acc])
]]>
		</Resource>
	</TestCase>
  <TestCase name="testTopNWithKeyChanged">
	<Resource name="plan">
		<![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[b], orderBy=[sum_c DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[RetractRank], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[b]])
    StreamExecGroupAggregate(groupBy=[a], select=[a, LAST_VALUE(b) AS b, SUM(c) AS sum_c])
      StreamExecExchange(distribution=[hash[a]])
        StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
	</Resource>
	<Resource name="trait">
		<![CDATA[
StreamExecRank(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[true], accMode=[AccRetract])
    StreamExecGroupAggregate(retract=[true], accMode=[AccRetract])
      StreamExecExchange(retract=[true], accMode=[Acc])
        StreamExecDataStreamScan(retract=[true], accMode=[Acc])
]]>
	</Resource>
  </TestCase>
  <TestCase name="testNestedTopN">
    <Resource name="plan">
      <![CDATA[
StreamExecCalc(select=[a, b, count_c, w0$o0])
  StreamExecRank(rankFunction=[ROW_NUMBER], orderBy=[count_c DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[UpdateFastRank[0,1]], select=[*, rowNum])
    StreamExecExchange(distribution=[single])
      StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[a], orderBy=[count_c DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[UpdateFastRank[0,1]], select=[*, rowNum])
        StreamExecExchange(distribution=[hash[a]])
          StreamExecGroupAggregate(groupBy=[a, b], select=[a, b, COUNT(*) AS count_c])
            StreamExecExchange(distribution=[hash[a, b]])
              StreamExecCalc(select=[a, b, 'cn' AS cn])
                StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecCalc(retract=[false], accMode=[Acc])
  StreamExecRank(retract=[false], accMode=[Acc])
    StreamExecExchange(retract=[false], accMode=[Acc])
      StreamExecRank(retract=[false], accMode=[Acc])
        StreamExecExchange(retract=[false], accMode=[Acc])
          StreamExecGroupAggregate(retract=[false], accMode=[Acc])
            StreamExecExchange(retract=[true], accMode=[Acc])
              StreamExecCalc(retract=[true], accMode=[Acc])
                StreamExecDataStreamScan(retract=[true], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
  <TestCase name="testOrderByFetch">
    <Resource name="plan">
      <![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], orderBy=[a ASC, b DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[AppendFastRank], select=[*])
  StreamExecExchange(distribution=[single])
    StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecRank(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[false], accMode=[Acc])
    StreamExecDataStreamScan(retract=[false], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
  <TestCase name="testOrderByLimit">
    <Resource name="plan">
      <![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], orderBy=[a ASC, b DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[AppendFastRank], select=[*])
  StreamExecExchange(distribution=[single])
    StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecRank(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[false], accMode=[Acc])
    StreamExecDataStreamScan(retract=[false], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
  <TestCase name="testTopN">
    <Resource name="plan">
      <![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[a], orderBy=[b DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[AppendFastRank], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[a]])
    StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecRank(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[false], accMode=[Acc])
    StreamExecDataStreamScan(retract=[false], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
  <TestCase name="testTopN2">
    <Resource name="plan">
      <![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[a], orderBy=[b DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[AppendFastRank], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[a]])
    StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecRank(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[false], accMode=[Acc])
    StreamExecDataStreamScan(retract=[false], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
  <TestCase name="testTopNOrderByCountAndOtherField">
    <Resource name="plan">
      <![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[b], orderBy=[count_c DESC, a ASC], rankRange=[rankStart=1, rankEnd=10], strategy=[UpdateFastRank[0,1]], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[b]])
    StreamExecGroupAggregate(groupBy=[a, b], select=[a, b, COUNT(*) AS count_c])
      StreamExecExchange(distribution=[hash[a, b]])
        StreamExecCalc(select=[a, b])
          StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecRank(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[false], accMode=[Acc])
    StreamExecGroupAggregate(retract=[false], accMode=[Acc])
      StreamExecExchange(retract=[true], accMode=[Acc])
        StreamExecCalc(retract=[true], accMode=[Acc])
          StreamExecDataStreamScan(retract=[true], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
  <TestCase name="testTopNAfterAgg">
    <Resource name="plan">
      <![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[b], orderBy=[sum_c DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[UnaryUpdateRank[0,1]], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[b]])
    StreamExecGroupAggregate(groupBy=[a, b], select=[a, b, SUM(c) AS sum_c])
      StreamExecExchange(distribution=[hash[a, b]])
        StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecRank(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[false], accMode=[Acc])
    StreamExecGroupAggregate(retract=[false], accMode=[Acc])
      StreamExecExchange(retract=[true], accMode=[Acc])
        StreamExecDataStreamScan(retract=[true], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
  <TestCase name="testTopNOrderByCount">
    <Resource name="plan">
      <![CDATA[
StreamExecGroupAggregate(select=[MAX_RETRACT(a) AS EXPR$0])
  StreamExecExchange(distribution=[single])
    StreamExecCalc(select=[a])
      StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[b], orderBy=[count_c DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[UpdateFastRank[0,1]], select=[*])
        StreamExecExchange(distribution=[hash[b]])
          StreamExecGroupAggregate(groupBy=[a, b], select=[a, b, COUNT(*) AS count_c])
            StreamExecExchange(distribution=[hash[a, b]])
              StreamExecCalc(select=[a, b])
                StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecGroupAggregate(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[true], accMode=[AccRetract])
    StreamExecCalc(retract=[true], accMode=[AccRetract])
      StreamExecRank(retract=[true], accMode=[AccRetract])
        StreamExecExchange(retract=[false], accMode=[Acc])
          StreamExecGroupAggregate(retract=[false], accMode=[Acc])
            StreamExecExchange(retract=[true], accMode=[Acc])
              StreamExecCalc(retract=[true], accMode=[Acc])
                StreamExecDataStreamScan(retract=[true], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
  <TestCase name="testTopNWithoutRowNumber2">
    <Resource name="plan">
      <![CDATA[
StreamExecCalc(select=[CONCAT(seller_id, venture, stat_date, sku_id) AS rowkey, seller_id, sku_id, venture, stat_date, amt_dtr, byr_cnt_dtr, pv_dtr, uv_dtr])
  StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[seller_id, venture, stat_date], orderBy=[amt_dtr DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[UpdateFastRank[0,1,2,3]], select=[*])
    StreamExecExchange(distribution=[hash[seller_id, venture, stat_date]])
      StreamExecGroupAggregate(groupBy=[seller_id, sku_id, venture, stat_date], select=[seller_id, sku_id, venture, stat_date, increasing_sum(trd_amt) AS amt_dtr, COUNT(DISTINCT trd_buyer_id) AS byr_cnt_dtr, SUM(log_pv) AS pv_dtr, COUNT(DISTINCT log_visitor_id) AS uv_dtr])
        StreamExecExchange(distribution=[hash[seller_id, sku_id, venture, stat_date]])
          StreamExecDataStreamScan(table=[[_DataStreamTable_1]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecCalc(retract=[false], accMode=[Acc])
  StreamExecRank(retract=[false], accMode=[Acc])
    StreamExecExchange(retract=[false], accMode=[Acc])
      StreamExecGroupAggregate(retract=[false], accMode=[Acc])
        StreamExecExchange(retract=[true], accMode=[Acc])
          StreamExecDataStreamScan(retract=[true], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
  <TestCase name="testTopNForVariableSize">
    <Resource name="plan">
      <![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[b], orderBy=[c DESC], rankRange=[rankEnd=a], strategy=[UpdateFastRank[1]], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[b]])
    StreamExecCalc(select=[a, b, add(max_c) AS c])
      StreamExecGroupAggregate(groupBy=[b], select=[b, MAX(a) AS a, MAX(c) AS max_c])
        StreamExecExchange(distribution=[hash[b]])
          StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecRank(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[false], accMode=[Acc])
    StreamExecCalc(retract=[false], accMode=[Acc])
      StreamExecGroupAggregate(retract=[false], accMode=[Acc])
        StreamExecExchange(retract=[true], accMode=[Acc])
          StreamExecDataStreamScan(retract=[true], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
  <TestCase name="testTopNOrderBySumWithCond">
    <Resource name="plan">
      <![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[b], orderBy=[sum_c DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[UpdateFastRank[0,1]], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[b]])
    StreamExecGroupAggregate(groupBy=[a, b], select=[a, b, SUM(c) AS sum_c])
      StreamExecExchange(distribution=[hash[a, b]])
        StreamExecCalc(select=[a, b, c], where=[>=(c, 0)])
          StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecRank(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[false], accMode=[Acc])
    StreamExecGroupAggregate(retract=[false], accMode=[Acc])
      StreamExecExchange(retract=[true], accMode=[Acc])
        StreamExecCalc(retract=[true], accMode=[Acc])
          StreamExecDataStreamScan(retract=[true], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
	<TestCase name="testTopNOrderBySumWithCaseWhen">
		<Resource name="plan">
			<![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[b], orderBy=[sum_c DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[UpdateFastRank[0,1]], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[b]])
    StreamExecGroupAggregate(groupBy=[a, b], select=[a, b, SUM($f2) AS sum_c])
      StreamExecExchange(distribution=[hash[a, b]])
        StreamExecCalc(select=[a, b, CASE(>(c, 10), 1, <(c, 0), 0, null) AS $f2])
          StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
		</Resource>
	</TestCase>
	<TestCase name="testTopNOrderBySumWithIf">
		<Resource name="plan">
			<![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[b], orderBy=[sum_c DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[UpdateFastRank[0,1]], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[b]])
    StreamExecGroupAggregate(groupBy=[a, b], select=[a, b, SUM($f2) AS sum_c])
      StreamExecExchange(distribution=[hash[a, b]])
        StreamExecCalc(select=[a, b, IF(>(c, 10), 1, 0) AS $f2])
          StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
		</Resource>
	</TestCase>
	<TestCase name="testTopNOrderBySumWithFilterClause">
		<Resource name="plan">
			<![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[b], orderBy=[sum_c DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[UpdateFastRank[0,1]], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[b]])
    StreamExecGroupAggregate(groupBy=[a, b], select=[a, b, SUM(c) FILTER $f3 AS sum_c])
      StreamExecExchange(distribution=[hash[a, b]])
        StreamExecCalc(select=[a, b, c, IS TRUE(AND(>=(c, 0), <(a, 0))) AS $f3])
          StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
		</Resource>
	</TestCase>
  <TestCase name="testTopNOrderByUDAG">
    <Resource name="plan">
      <![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[b], orderBy=[sum_c DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[UpdateFastRank[0,1]], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[b]])
    StreamExecGroupAggregate(groupBy=[a, b], select=[a, b, increasing_sum(c) AS sum_c])
      StreamExecExchange(distribution=[hash[a, b]])
        StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecRank(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[false], accMode=[Acc])
    StreamExecGroupAggregate(retract=[false], accMode=[Acc])
      StreamExecExchange(retract=[true], accMode=[Acc])
        StreamExecDataStreamScan(retract=[true], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
  <TestCase name="testTopNth">
    <Resource name="plan">
      <![CDATA[
StreamExecCalc(select=[a, b, c, 10 AS rank_num])
  StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[a], orderBy=[b DESC], rankRange=[rankStart=10, rankEnd=10], strategy=[AppendFastRank], select=[*])
    StreamExecExchange(distribution=[hash[a]])
      StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecCalc(retract=[false], accMode=[Acc])
  StreamExecRank(retract=[false], accMode=[Acc])
    StreamExecExchange(retract=[false], accMode=[Acc])
      StreamExecDataStreamScan(retract=[false], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
  <TestCase name="testTopNWithFilter">
    <Resource name="plan">
      <![CDATA[
StreamExecCalc(select=[w0$o0 AS rank_num, a, c], where=[IS NOT NULL(b)])
  StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[a], orderBy=[b DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[AppendFastRank], select=[*, rowNum])
    StreamExecExchange(distribution=[hash[a]])
      StreamExecCalc(select=[a, b, c], where=[>(c, 1000)])
        StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecCalc(retract=[false], accMode=[Acc])
  StreamExecRank(retract=[false], accMode=[Acc])
    StreamExecExchange(retract=[false], accMode=[Acc])
      StreamExecCalc(retract=[false], accMode=[Acc])
        StreamExecDataStreamScan(retract=[false], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
  <TestCase name="testTopNWithGroupByConstantKey">
    <Resource name="plan">
      <![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[a], orderBy=[count_c DESC], rankRange=[rankStart=1, rankEnd=10], strategy=[UpdateFastRank[0,1]], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[a]])
    StreamExecGroupAggregate(groupBy=[a, b], select=[a, b, COUNT(*) AS count_c])
      StreamExecExchange(distribution=[hash[a, b]])
        StreamExecCalc(select=[a, b, 'cn' AS cn])
          StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecRank(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[false], accMode=[Acc])
    StreamExecGroupAggregate(retract=[false], accMode=[Acc])
      StreamExecExchange(retract=[true], accMode=[Acc])
        StreamExecCalc(retract=[true], accMode=[Acc])
          StreamExecDataStreamScan(retract=[true], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
  <TestCase name="testTopNWithGroupByTwoAgg">
    <Resource name="plan">
      <![CDATA[
StreamExecRank(rankFunction=[ROW_NUMBER], partitionBy=[b], orderBy=[sum_c DESC, cnt ASC], rankRange=[rankStart=1, rankEnd=10], strategy=[ApproxUpdateRank[0,1]], select=[*, rowNum])
  StreamExecExchange(distribution=[hash[b]])
    StreamExecGroupAggregate(groupBy=[a, b], select=[a, b, SUM(c) AS sum_c, COUNT(c) AS cnt])
      StreamExecExchange(distribution=[hash[a, b]])
        StreamExecDataStreamScan(table=[[_DataStreamTable_0]])
]]>
    </Resource>
    <Resource name="trait">
      <![CDATA[
StreamExecRank(retract=[false], accMode=[Acc])
  StreamExecExchange(retract=[false], accMode=[Acc])
    StreamExecGroupAggregate(retract=[false], accMode=[Acc])
      StreamExecExchange(retract=[true], accMode=[Acc])
        StreamExecDataStreamScan(retract=[true], accMode=[Acc])
]]>
    </Resource>
  </TestCase>
</Root>
